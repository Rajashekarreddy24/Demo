import{a as rt}from"./chunk-CYKCQD5B.js";import{A as tt,U as et,c as Z,e as q,g as J,i as Q,m as W,w as X,z as $}from"./chunk-GR2TZYVC.js";import"./chunk-LOSEKLOO.js";import{Cb as d,Eb as A,Gc as G,Ja as f,Ka as p,Kb as K,Kc as H,Oc as Y,Pa as M,Qb as B,Rb as j,Xa as C,Za as g,aa as N,cb as w,db as b,ec as I,ga as v,ha as E,hc as L,ib as l,ic as R,ja as F,jb as a,kb as D,mc as z,ob as P,pa as h,qa as y,rb as _,sb as c,tc as U,wb as k,xa as V,ya as T}from"./chunk-CB3CSPGG.js";import"./chunk-BRV2THHE.js";import{f as ot}from"./chunk-WT5K5NLM.js";function lt(o,r){if(o&1){let t=P();l(0,"input",4,0),_("paste",function(e){h(t);let n=c(2);return y(n.handlePaste(e))})("keyup",function(e){let n=h(t).index,s=c(2);return y(s.onKeyUp(e,n))})("input",function(e){h(t);let n=c(2);return y(n.onInput(e))})("keydown",function(e){let n=h(t).index,s=c(2);return y(s.onKeyDown(e,n))}),a()}if(o&2){let t=r.$implicit,i=r.index,e=c(2);w("otp-input ",e.config.inputClass,""),g("pattern",e.config.allowNumbersOnly?"\\d*":"")("type",e.inputType)("placeholder",(e.config==null?null:e.config.placeholder)||"")("ngStyle",e.config.inputStyles)("formControl",e.otpForm.controls[t])("id",e.getBoxId(i))}}function at(o,r){if(o&1&&(l(0,"div",2),C(1,lt,2,9,"input",3),B(2,"keys"),a()),o&2){let t=c();w("ng-otp-input-wrapper wrapper ",t.config.containerClass,""),k("id","c_",t.componentKey,""),g("ngStyle",t.config.containerStyles),f(),g("ngForOf",j(2,7,t.otpForm==null?null:t.otpForm.controls))}}var m=class{static ifTab(r){return this.ifKey(r,"Tab")}static ifDelete(r){return this.ifKey(r,"Delete;Del")}static ifBackspace(r){return this.ifKey(r,"Backspace")}static ifRightArrow(r){return this.ifKey(r,"ArrowRight;Right")}static ifLeftArrow(r){return this.ifKey(r,"ArrowLeft;Left")}static ifSpacebar(r){return this.ifKey(r,"Spacebar; ")}static ifKey(r,t){return t.split(";").some(e=>e===r.key)}},O=(()=>{class o{transform(t){return Object.keys(t)}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275pipe=F({name:"keys",type:o,pure:!0}),o})(),it=(()=>{class o{constructor(t,i){this.keysPipe=t,this.document=i,this.config={length:4},this.onInputChange=new T,this.inputControls=new Array(this.config.length),this.componentKey=Math.random().toString(36).substring(2)+new Date().getTime().toString(36)}get inputType(){return this.config?.isPasswordInput?"password":this.config?.allowNumbersOnly?"tel":"text"}ngOnInit(){this.otpForm=new J({});for(let t=0;t<this.config.length;t++)this.otpForm.addControl(this.getControlName(t),new Q);this.otpForm.valueChanges.subscribe(t=>{this.keysPipe.transform(this.otpForm.controls).forEach(i=>{var e=this.otpForm.controls[i].value;e&&e.length>1&&(e.length>=this.config.length?this.setValue(e):this.rebuildValue())})})}ngAfterViewInit(){if(!this.config.disableAutoFocus){let t=this.document.getElementById(`c_${this.componentKey}`);if(t){let i=t.getElementsByClassName("otp-input")[0];i&&i.focus&&i.focus()}}}getControlName(t){return`ctrl_${t}`}onKeyDown(t,i){let e=this.getBoxId(i-1),n=this.getBoxId(i);if(m.ifSpacebar(t))return t.preventDefault(),!1;if(m.ifBackspace(t)){t.target.value?this.clearInput(n,i):(this.clearInput(e,i-1),this.setSelected(e)),this.rebuildValue();return}}onInput(t){let i=this.currentVal?`${this.currentVal}${t.target.value}`:t.target.value;if(this.config.allowNumbersOnly&&!this.validateNumber(i)){t.target.value="",t.stopPropagation(),t.preventDefault();return}}onKeyUp(t,i){m.ifTab(t)&&(i-=1);let e=this.getBoxId(i+1),n=this.getBoxId(i-1),s=this.getBoxId(i);if(m.ifRightArrow(t)){t.preventDefault(),this.setSelected(e);return}if(m.ifLeftArrow(t)){t.preventDefault(),this.setSelected(n);return}if(m.ifDelete(t)){t.target.value?this.clearInput(s,i):(this.clearInput(n,i-1),this.setSelected(n)),this.rebuildValue();return}t.target.value&&(this.ifValidKeyCode(t)&&this.setSelected(e),this.rebuildValue())}validateNumber(t){return t&&/^[0-9]+$/.test(t)}getBoxId(t){return`otp_${t}_${this.componentKey}`}clearInput(t,i){let e=this.getControlName(i);this.otpForm.controls[e]?.setValue(null);let n=this.document.getElementById(t);n&&n instanceof HTMLInputElement&&(n.value=null)}setSelected(t){this.focusTo(t);let i=this.document.getElementById(t);i&&i.setSelectionRange&&setTimeout(()=>{i.setSelectionRange(0,1)},0)}ifValidKeyCode(t){let i=t.key;return/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)||/[a-zA-Z0-9-_]/.test(i)}focusTo(t){let i=this.document.getElementById(t);i&&i.focus()}setValue(t){if(!(this.config.allowNumbersOnly&&isNaN(t))){if(this.otpForm.reset(),!t){this.rebuildValue();return}if(t=t.toString().replace(/\s/g,""),Array.from(t).forEach((e,n)=>{this.otpForm.get(this.getControlName(n))&&this.otpForm.get(this.getControlName(n)).setValue(e)}),!this.config.disableAutoFocus){let e=this.document.getElementById(`c_${this.componentKey}`);var i=t.length<this.config.length?t.length:this.config.length-1;let n=e.getElementsByClassName("otp-input")[i];n&&n.focus&&n.focus()}this.rebuildValue()}}rebuildValue(){let t="";this.keysPipe.transform(this.otpForm.controls).forEach(i=>{if(this.otpForm.controls[i].value){let e=this.otpForm.controls[i].value,n=e.length>1,s=!this.config.allowNumbersOnly&&this.config.letterCase&&(this.config.letterCase.toLocaleLowerCase()=="upper"||this.config.letterCase.toLocaleLowerCase()=="lower");e=e[0];let u=s?this.config.letterCase.toLocaleLowerCase()=="upper"?e.toUpperCase():e.toLowerCase():e;s&&u==e?s=!1:e=u,t+=e,(n||s)&&this.otpForm.controls[i].setValue(e)}}),this.formCtrl?.setValue&&this.formCtrl.setValue(t),this.onInputChange.emit(t),this.currentVal=t}handlePaste(t){let i=t.clipboardData||window.clipboardData;if(i)var e=i.getData("Text");t.stopPropagation(),t.preventDefault(),!(!e||this.config.allowNumbersOnly&&!this.validateNumber(e))&&this.setValue(e)}}return o.\u0275fac=function(t){return new(t||o)(p(O),p(I))},o.\u0275cmp=v({type:o,selectors:[["ng-otp-input"]],inputs:{config:"config",formCtrl:"formCtrl"},outputs:{onInputChange:"onInputChange"},decls:1,vars:1,consts:[["inp",""],[3,"class","id","ngStyle",4,"ngIf"],[3,"id","ngStyle"],["autocomplete","one-time-code",3,"pattern","type","placeholder","ngStyle","class","formControl","id","paste","keyup","input","keydown",4,"ngFor","ngForOf"],["autocomplete","one-time-code",3,"paste","keyup","input","keydown","pattern","type","placeholder","ngStyle","formControl","id"]],template:function(t,i){t&1&&C(0,at,3,9,"div",1),t&2&&g("ngIf",i.otpForm==null?null:i.otpForm.controls)},dependencies:[R,z,L,Z,X,q,W,O],styles:[".otp-input[_ngcontent-%COMP%]{width:50px;height:50px;border-radius:4px;border:solid 1px #c5c5c5;text-align:center;font-size:32px}.ng-otp-input-wrapper[_ngcontent-%COMP%]   .otp-input[_ngcontent-%COMP%]:not(:last-child){margin-right:8px}@media screen and (max-width: 767px){.otp-input[_ngcontent-%COMP%]{width:40px;font-size:24px;height:40px}}@media screen and (max-width: 420px){.otp-input[_ngcontent-%COMP%]{width:30px;font-size:18px;height:30px}}"]}),o})(),nt=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=E({type:o}),o.\u0275inj=N({providers:[O],imports:[[U,$,tt]]}),o})();var S=ot(rt());function ct(o,r){if(o&1&&(l(0,"p"),d(1),a()),o&2){let t=c();f(),A("Didn't recieved otp? Resend in ",t.display,"s")}}function ut(o,r){o&1&&(l(0,"a"),d(1,"Resend OTP"),a())}var Ft=(()=>{let r=class r{constructor(i,e,n,s,u,x){this.document=i,this.elementRef=e,this.authService=n,this.router=s,this.renderer=u,this.sanitizer=x,this.config={allowNumbersOnly:!0,length:5,isPasswordInput:!1,disableAutoFocus:!1,placeholder:"",inputStyles:{width:"50px",height:"50px"}},this.resendOtp=!1,this.displayTimer=!1}ngOnInit(){this.renderer.addClass(this.document.body,"login-img"),this.renderer.addClass(this.document.body,"ltr"),this.renderer.addClass(this.document.body,"app-sidebar-mini"),this.start(1)}ngOnDestroy(){this.renderer.removeClass(this.document.body,"login-img"),this.renderer.removeClass(this.document.body,"ltr")}start(i){this.displayTimer=!0,this.resendOtp=!1;let e=i*60,n="0",s=60,u=i<10?"0":"",x=setInterval(()=>{e--,s!=0?s--:s=59,s<10?(console.log("inside",s),n="0"+s):(console.log("else",s),n=s),this.display=`${u}${Math.floor(e/60)}:${n}`,e==0&&(console.log("finished"),clearInterval(x),this.resendOtp=!0,this.displayTimer=!1)},1e3)}onOtpChange(i){this.otp=i}validateOtp(){let i={otp:this.otp};this.authService.validateOtp(i).subscribe({next:e=>{console.log(e),(e.message="Account successfully activated")&&(S.default.fire({icon:"success",title:"Congratulations!",text:"Your Email is verified!, Please Login",width:"400px"}),this.router.navigate(["/authentication/login"]))},error:e=>{console.log(e),e&&S.default.fire({icon:"error",title:"Congratulations!",text:e.error.message,width:"400px"})}})}};r.\u0275fac=function(e){return new(e||r)(p(I),p(V),p(et),p(H),p(M),p(G))},r.\u0275cmp=v({type:r,selectors:[["app-email-activation"]],standalone:!0,features:[K],decls:30,vars:3,consts:[[1,""],[1,"text-center"],["src","./assets/images/brand/insightappstext.png","alt","",1,"header-brand-img","m-0"],[1,"container-lg"],[1,"row","justify-content-center","mt-4","mx-0"],[1,"col-xl-4","col-lg-6","col-md-6","col-sm-6"],[1,"card","shadow-none"],[1,"card-body","p-sm-6"],[1,"text-center","mb-4"],[1,"mb-1"],[1,"row"],[1,"col-sm-12"],[1,"mb-3"],[1,"mb-2","fw-500"],[1,"text-danger","ms-1"],[3,"onInputChange","config"],[1,"col-xl-12"],[1,"d-grid","mb-3"],[1,"btn","btn-primary",3,"click"],[2,"float","right"]],template:function(e,n){e&1&&(l(0,"div",0)(1,"div",1)(2,"a"),D(3,"img",2),a()()(),l(4,"div",3)(5,"div",4)(6,"div",5)(7,"div",6)(8,"div",7)(9,"div",8)(10,"h4",9),d(11,"Email Activation"),a(),l(12,"p"),d(13,"Enter otp sent to registered E-mail."),a()(),l(14,"div",10)(15,"div",11)(16,"div",12)(17,"label",13),d(18,"OTP"),l(19,"span",14),d(20,"*"),a()(),l(21,"ng-otp-input",15),_("onInputChange",function(u){return n.onOtpChange(u)}),a()()(),l(22,"div",16)(23,"div",17)(24,"a",18),_("click",function(){return n.validateOtp()}),d(25," Submit"),a()(),l(26,"div",1)(27,"div",19),C(28,ct,2,1,"p")(29,ut,2,0,"a"),a()()()()()()()()()),e&2&&(f(21),g("config",n.config),f(7),b(28,n.displayTimer?28:-1),f(),b(29,n.resendOtp?29:-1))},dependencies:[Y,nt,it]});let o=r;return o})();export{Ft as EmailActivationComponent};
